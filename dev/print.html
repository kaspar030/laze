<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>laze Manual</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting_started.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="execution.html"><strong aria-hidden="true">3.</strong> Running Laze</a></li><li class="chapter-item expanded affix "><li class="part-title">Concepts</li><li class="chapter-item expanded "><a href="concepts/lazefiles.html"><strong aria-hidden="true">4.</strong> Build Files</a></li><li class="chapter-item expanded "><a href="concepts/types.html"><strong aria-hidden="true">5.</strong> Apps, Builders, Contexts, Modules</a></li><li class="chapter-item expanded "><a href="concepts/dependencies.html"><strong aria-hidden="true">6.</strong> Module Dependencies</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference</li><li class="chapter-item expanded "><a href="reference/overview.html"><strong aria-hidden="true">7.</strong> Overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/context.html"><strong aria-hidden="true">7.1.</strong> context</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/rule.html"><strong aria-hidden="true">7.1.1.</strong> rule</a></li><li class="chapter-item expanded "><a href="reference/tasks.html"><strong aria-hidden="true">7.1.2.</strong> tasks</a></li></ol></li><li class="chapter-item expanded "><a href="reference/builder.html"><strong aria-hidden="true">7.2.</strong> builder</a></li><li class="chapter-item expanded "><a href="reference/module.html"><strong aria-hidden="true">7.3.</strong> module</a></li><li class="chapter-item expanded "><a href="reference/app.html"><strong aria-hidden="true">7.4.</strong> app</a></li><li class="chapter-item expanded "><a href="reference/subdirs.html"><strong aria-hidden="true">7.5.</strong> subdirs</a></li><li class="chapter-item expanded "><a href="reference/import.html"><strong aria-hidden="true">7.6.</strong> import</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">laze Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><strong>laze</strong> is a build system for C/C++ projects. It can be used in many cases
instead of Make, CMake or Meson.</p>
<p>It's main differentiators are:</p>
<ul>
<li>declarative, <strong>easy to use</strong> yaml-based build descriptions</li>
<li>designed to <strong>handle massively modular projects</strong>
<ul>
<li>main driver: <a href="https://github.com/RIOT-OS/RIOT">RIOT OS</a>, which builds
&gt; 100k configurations as part of its CI testing</li>
<li>powerful module system</li>
<li>first-class cross compilation</li>
<li>first-class multi-repository support</li>
</ul>
</li>
<li>optimized for <strong>fast build configuration</strong>
<ul>
<li>written in Rust</li>
<li>extensive caching</li>
<li>multithreaded build configuration</li>
</ul>
</li>
<li>optimized for <strong>fast building</strong>
<ul>
<li>automatically re-uses objects that are built identically for different
build configurations</li>
</ul>
</li>
<li>actual building is done transparently by <a href="https://ninja-build.org/">Ninja</a></li>
</ul>
<p>This book contains a guide on how to install and use laze, and a reference for
its build description format.</p>
<h2 id="how-does-it-look"><a class="header" href="#how-does-it-look">How does it look</a></h2>
<p>Consider a simple application consisting of a single <code>hello.c</code> source file.</p>
<p>This laze file would build it:</p>
<pre><code class="language-yaml"># import default context and host builder
import:
  - laze: defaults

# define an application named &quot;hello&quot;
app:
  - name: hello
    sources:
      - hello.c
</code></pre>
<p>The application can now be built:</p>
<pre><code>laze build
</code></pre>
<p>The resulting executable ends up in <code>build/out/host/hello/hello.elf</code>.</p>
<p>Alternatively,</p>
<pre><code>laze task run
</code></pre>
<p>Would run the executable, (re-)building it if necessary.</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>laze is free and open source. You can find the source code on GitHub and issues
and feature requests can be posted on the GitHub issue tracker. laze relies on
the community to fix bugs and add features: if you'd like to contribute, please
read the CONTRIBUTING guide and consider opening a pull request.</p>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>laze source code is released under the <a href="https://github.com/kaspar030/laze/blob/master/LICENSE">Apache 2.0 license</a>.</p>
<p>This book has been heavily inspired by and is based on the <a href="https://rust-lang.github.io/mdBook/">mdBook user guide</a>,
and is thus licenced under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License v2.0</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>There are multiple ways to install the laze CLI tool.
Choose any one of the methods below that best suit your needs.
If you are installing laze for automatic deployment, check out the <a href="../continuous-integration.html">continuous integration</a> chapter for more examples on how to install.</p>
<h2 id="distribution-packages"><a class="header" href="#distribution-packages">Distribution packages</a></h2>
<p>The easiest way to install laze is probably by using a package for your
distribution.</p>
<p>Available packages:</p>
<table><thead><tr><th>Distribution                      </th><th>Package name</th></tr></thead><tbody>
<tr><td>Arch Linux AUR</td><td><a href="https://aur.archlinux.org/packages/laze-bin"><code>laze-bin</code></a></td></tr>
</tbody></table>
<h2 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h2>
<p>laze requires <a href="https://ninja-build.org">Ninja</a>. You can <a href="https://github.com/ninja-build/ninja/releases">download the Ninja binary</a> or <a href="https://github.com/ninja-build/ninja/wiki/Pre-built-Ninja-packages">find it in your system's package manager</a>.</p>
<h2 id="pre-compiled-binaries"><a class="header" href="#pre-compiled-binaries">Pre-compiled binaries</a></h2>
<p>Executable binaries are available for download on the <a href="https://github.com/kaspar030/laze/releases">GitHub Releases page</a>.
Download the binary for your platform (Windows, macOS, or Linux) and extract
the archive. The archive contains <code>laze</code> executable.</p>
<p>To make it easier to run, put the path to the binary into your <code>PATH</code>.</p>
<h2 id="build-from-source-using-rust"><a class="header" href="#build-from-source-using-rust">Build from source using Rust</a></h2>
<p>To build the <code>mdbook</code> executable from source, you will first need to install Rust and Cargo.
Follow the instructions on the <a href="https://www.rust-lang.org/tools/install">Rust installation page</a>.
laze currently requires at least Rust version 1.54.</p>
<p>Once you have installed Rust, the following command can be used to build and install laze:</p>
<pre><code class="language-sh">cargo install laze
</code></pre>
<p>This will automatically download laze from <a href="https://crates.io/">crates.io</a>, build it, and install it in Cargo's global binary directory (<code>~/.cargo/bin/</code> by default).</p>
<h3 id="installing-the-latest-master-version"><a class="header" href="#installing-the-latest-master-version">Installing the latest master version</a></h3>
<p>The version published to crates.io will ever so slightly be behind the version hosted on GitHub.
If you need the latest version you can build the git version of laze yourself.
Cargo makes this <strong><em>super easy</em></strong>!</p>
<pre><code class="language-sh">cargo install --git https://github.com/kaspar030.git laze
</code></pre>
<p>Again, make sure to add the Cargo bin directory to your <code>PATH</code>.</p>
<p>If you are interested in making modifications to laze itself, check out the <a href="https://github.com/kaspar030/laze/blob/master/CONTRIBUTING.md">Contributing Guide</a> for more information.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="running-laze"><a class="header" href="#running-laze">Running Laze</a></h1>
<p>To build an application for a builder, run</p>
<pre><code>laze build -b &lt;builder&gt; -a &lt;application&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h3 id="build-file-structure"><a class="header" href="#build-file-structure">Build file structure</a></h3>
<p>laze uses yaml files to describe a project.</p>
<p>Each laze project consists of a file named <code>laze-project.yml</code> in the project's
root folder, and any number of <code>laze.yml</code> files in subdirectories.</p>
<p>laze will always read <code>laze-project.yml</code> and all referenced <code>laze.yml</code> files of
a project. Don't worry, that's fairly fast, e.g., reading and parsing ~650 build
files of RIOT takes ~35ms on a Thinkpad T480s. And it's cached, if no buildfile
has been changed since it was last read, loading the cache takes less than 10ms.</p>
<p>Once laze has read the build files, it will <em>configure</em> builds as requested
when executing it. This will resolve all dependencies for the requested builds,
configure the environments and write a Ninja build file.</p>
<p>Once done configuring, laze will automatically call Ninja with the changed build
configuration. Ninja will then do the actual building.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="builds-apps-builders-contexts-modules"><a class="header" href="#builds-apps-builders-contexts-modules">Builds, Apps, Builders, Contexts, Modules</a></h3>
<p>Conceptionally laze builds <strong>apps</strong> for <strong>builders</strong>.
Each app/builder combination that laze configures is called a <strong>build</strong>.</p>
<p>An <strong>app</strong> represents a binary, and a <strong>builder</strong> would be e.g., the toolchain
configuration for the host system.</p>
<p>Builders are <strong>contexts</strong>. All contexts (and thus builders) have a parent,
up to the root context which is called &quot;default&quot;. A builder is just a context
that apps can be built for.</p>
<p>A context could be &quot;linux&quot;, or &quot;ubuntu&quot; with parent context &quot;linux&quot;. A builder
could then be &quot;amd64&quot; with parent context &quot;ubuntu&quot;. Builders can have other
builders as parent context.</p>
<p>Apps can depend on <strong>modules</strong>, which can have dependencies themselves.
Technically, an app is just a special kind of module that can be built for a
builder.</p>
<p>Apps and modules consist of zero or more source files.</p>
<div style="break-before: page; page-break-before: always;"></div><h3 id="module-dependencies"><a class="header" href="#module-dependencies">Module Dependencies</a></h3>
<p>Apps/modules can depend on other modules. There are multiple depencency types:</p>
<ol>
<li>
<p>&quot;depends&quot; -&gt; a hard dependency.</p>
<p>This module won't work unless the dependency is usable (not disabled, not
conflicted by another module and its own dependencies can be resolved).
It is pulled in and the dependency's exported environment will be imported.</p>
<p>&quot;depends&quot; is equivalent to specifying both &quot;selects&quot; &quot;uses&quot;.</p>
</li>
<li>
<p>&quot;selects&quot; -&gt; also a hard dependency, like 1.), the dependency will be pulled in,
but the dependency's exported environment will <em>not</em> be imported.</p>
</li>
<li>
<p>&quot;uses&quot; -&gt; this module is affected by the dependency.</p>
<p>The dependency will not be pulled in by this module, but if it is part of the
build through other means (e.g., another module depends on it), this module
will import the dependency's exported environment.</p>
</li>
<li>
<p>&quot;conflicts&quot; -&gt; the modules cannot be used together in the same build.</p>
</li>
<li>
<p>&quot;optionally depends&quot; -&gt; a soft dependency</p>
<p>If the dependency is usable (not disabled, not conflicted by another module
and its own dependencies can be resolved), it will be pulled in and its
exported environment will be imported.</p>
</li>
<li>
<p>&quot;if this than that&quot; -&gt; if &quot;this&quot; is part of the dependency tree, &quot;depend&quot; on &quot;that&quot;</p>
</li>
<li>
<p>&quot;optional if this than that&quot; -&gt; same as 6.) but as soft dependency.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="laze-file-reference"><a class="header" href="#laze-file-reference">Laze File Reference</a></h1>
<p>This chapter contains the referencs of laze's YAML build files.</p>
<p>TODO: it is currently incomplete ...</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="context"><a class="header" href="#context">context</a></h1>
<p><code>context</code> contains a <em>list</em> of context entries.
Each context <em>must</em> have a <code>name</code> field, all other fields are optional.</p>
<p>Example:</p>
<pre><code class="language-yaml">context:
 - name: name_of_this_context.
   # ... possible other fields
 - name: name_of_other_context
   # ... possible other fields
</code></pre>
<h2 id="context-fields"><a class="header" href="#context-fields">context fields</a></h2>
<h3 id="parent"><a class="header" href="#parent"><code>parent</code></a></h3>
<p>The parent of this context. If unset, defaults to <code>default</code>.</p>
<p>Example:</p>
<pre><code class="language-yaml">context:
 - name: some_name
   parent: other_context_name
</code></pre>
<h3 id="env"><a class="header" href="#env"><code>env</code></a></h3>
<p>A <em>map</em> of variables.
Each map key correspondents to the variable name.
Each value must be either a single value or a list of values.</p>
<p>Example:</p>
<pre><code class="language-yaml">context:
 - name: some_name
   env:
     CFLAGS:
       - -D_this_is_a_list
       - -D_of_multiple_values
     LINKFLAGS: -Ithis_is_a_single_value
</code></pre>
<h3 id="selects"><a class="header" href="#selects"><code>selects</code></a></h3>
<p>List of modules that are always selected for builds in this context or any of
its children.</p>
<p>Example:</p>
<pre><code class="language-yaml">context:
 - name: birthday_party
   selects:
     - cake
     - music
</code></pre>
<h3 id="disable"><a class="header" href="#disable"><code>disable</code></a></h3>
<p>List of modules that are disabled for builds in this context or any of
its children.</p>
<p>Example:</p>
<pre><code class="language-yaml">context:
 - name: kids_birthday_party
   parent: birthday_party
   disables:
     - beer
</code></pre>
<h3 id="rule"><a class="header" href="#rule"><code>rule</code></a></h3>
<p>TODO</p>
<h3 id="var_options"><a class="header" href="#var_options"><code>var_options</code></a></h3>
<p>TODO</p>
<h3 id="tasks"><a class="header" href="#tasks"><code>tasks</code></a></h3>
<p>TODO</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rule-1"><a class="header" href="#rule-1">rule</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tasks-1"><a class="header" href="#tasks-1">tasks</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="builder"><a class="header" href="#builder">builder</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="module"><a class="header" href="#module">module</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="app"><a class="header" href="#app">app</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subdirs"><a class="header" href="#subdirs">subdirs</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="import"><a class="header" href="#import">import</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
